<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EcoID - Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background:#f1f8e9;
      margin:0;
      padding:0;
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    /* Header */
header {
  background: #2e7d32;
  color: white;
  padding: 0px 40px; /* top/bottom 15px, left/right 40px */
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

header h1.floating-logo {
  cursor: pointer;
  font-family: 'Poppins', sans-serif;
  font-size: 1.9rem;
  font-weight: 600;
  color: white;
  transition: color 0.3s ease;
  margin-left: 10px; /* moves EcoID slightly inward from left */
}

header button {
  background: white;
  color: #2e7d32;
  border: none;
  padding: 8px 12px;
  border-radius: 5px;
  cursor: pointer;
  margin-right: 10px; /* moves Logout slightly inward from right */
}



    /* Floating logo style */
    .floating-logo {
      cursor: pointer;
      font-family: 'Poppins', sans-serif;
      font-size: 1.8rem;
      font-weight: 600;
      color: white;
      transition: color 0.3s ease;
    }
    .floating-logo:hover {
      color: #79B791;
    }

    main {
      padding:20px;
      width:100%;
      max-width:900px;
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    .card {
      background:white;
      padding:20px;
      border-radius:10px;
      box-shadow:0 0 5px rgba(0,0,0,0.1);
      margin-bottom:20px;
      width:100%;
    }

    table {
      width:100%;
      border-collapse:collapse;
      display:block;
      max-height:400px;
      overflow-y:auto;
    }

    th, td {
      border-bottom:1px solid #ddd;
      padding:8px;
      text-align:left;
    }

    th {
      background:#e8f5e9;
    }

    td {
      white-space:nowrap;
    }

    button.action {
      background:#2e7d32;
      color:white;
      border:none;
      border-radius:5px;
      padding:5px 10px;
      cursor:pointer;
    }

    button.delete {
      background:#c62828;
    }

    input, select, textarea {
      width:100%;
      padding:8px;
      margin:5px 0 10px 0;
      border:1px solid #ccc;
      border-radius:5px;
      box-sizing:border-box;
    }

    h3 { margin-top:20px; border-bottom:1px solid #ccc; padding-bottom:5px; }

    /* Modal */
    .modal {
      display:none;
      position:fixed;
      z-index:100;
      left:0;
      top:0;
      width:100%;
      height:100%;
      overflow:auto;
      background:rgba(0,0,0,0.6);
    }

    .modal-content {
      background:#fff;
      margin:50px auto;
      padding:20px;
      border-radius:10px;
      width:90%;
      max-width:700px;
      position:relative;
      max-height:90vh;
      overflow-y:auto;
    }

    .close {
      color:#aaa;
      position:absolute;
      top:10px;
      right:15px;
      font-size:28px;
      font-weight:bold;
      cursor:pointer;
    }

    .close:hover { color:#000; }
    .file-input { border:none; padding:0; }
  </style>
</head>
<body>
<header>
  <div style="padding-left: 20px;">
    <h1 class="floating-logo" onclick="window.location.href='Main.html'">EcoID</h1>
  </div>
  <button id="logoutBtn">Logout</button>
</header>


  <main>
    <!-- Student Form -->
    <div class="card" id="studentFormCard">
      <h2><center>MATS College of Technology ID Registration Form</center></h2><br><br>
      <!-- Personal Information -->
      <h3>Personal Information</h3>
      <input type="text" id="fullName" placeholder="Full Name (Last, First, Middle)" required>
      <input type="text" id="studentID" placeholder="Student Number / ID Number">
      <input type="date" id="dob" placeholder="Date of Birth">
      <input type="number" id="age" placeholder="Age">
      <select id="gender">
        <option value="">Select Gender</option>
        <option>Male</option>
        <option>Female</option>
        <option>Other</option>
      </select>
      <input type="text" id="civilStatus" placeholder="Civil Status">
      <input type="text" id="nationality" placeholder="Nationality / Citizenship">
      <input type="text" id="religion" placeholder="Religion">
      <input type="text" id="bloodType" placeholder="Blood Type">

      <!-- Contact Information -->
      <h3>Contact Information</h3>
      <input type="text" id="homeAddress" placeholder="Home Address">
      <input type="text" id="mobileNumber" placeholder="Mobile Number">
      <input type="email" id="emailAddress" placeholder="Email Address">
      <input type="text" id="emergencyPerson" placeholder="Emergency Contact Person">
      <input type="text" id="emergencyRelation" placeholder="Relationship to Emergency Contact">
      <input type="text" id="emergencyNumber" placeholder="Emergency Contact Number">

      <!-- Academic Information -->
      <h3>Academic Information</h3>
      <input type="text" id="course" placeholder="Course / Program">
      <input type="text" id="yearLevel" placeholder="Year Level">
      <input type="text" id="section" placeholder="Section / Block">
      <input type="text" id="department" placeholder="Department / College Name">
      <select id="studentStatus">
        <option value="">Select Student Status</option>
        <option>New</option>
        <option>Old</option>
        <option>Transferee</option>
        <option>Returnee</option>
      </select>

      <!-- Family Information -->
      <h3>Family Information</h3>
      <input type="text" id="fatherName" placeholder="Fatherâ€™s Name">
      <input type="text" id="motherName" placeholder="Motherâ€™s Name">
      <input type="text" id="guardianName" placeholder="Guardianâ€™s Name">
      <input type="text" id="guardianContact" placeholder="Contact Number of Parent/Guardian">
      <input type="text" id="guardianOccupation" placeholder="Occupation of Parent/Guardian">

      <!-- ID Details -->
      <h3>ID Details</h3>
      <label for="idType">ID Type</label>
      <input type="text" id="idType">
      <label for="assignedID">ID Number</label>
      <input type="text" id="assignedID">
      <label for="studentSignature">Signature of Student</label>
      <input type="file" id="studentSignature" class="file-input">
      <label for="registrarSignature">Signature of Registrar</label>
      <input type="file" id="registrarSignature" class="file-input">
      <label for="applicationDate">Date of Application</label>
      <input type="date" id="applicationDate">
      <label for="photoBox">Photo (1x1 or 2x2)</label>
      <input type="file" id="photoBox" class="file-input">

      <!-- Optional / Special Sections -->
      <h3>Optional / Special Sections</h3>
      <input type="text" id="optionalBlood" placeholder="Blood Type (Emergency)">
      <textarea id="medicalConditions" placeholder="Medical Conditions / Allergies"></textarea>
      <input type="text" id="addressOnID" placeholder="Address on ID (Optional)">
      <input type="date" id="dateOfIssuance" placeholder="Date of Issuance">
      <textarea id="remarks" placeholder="Remarks / For Official Use Only"></textarea>

      <button class="action" style="margin-top:15px;" id="submitApp">Submit Application</button>
    </div>

    <!-- Admin Table -->
    <div class="card" id="adminDashboard" style="display:none;">
      <h2>Admin Dashboard</h2>
      <table id="appTable">
        <thead>
          <tr>
            <th>Name</th>
            <th>Course</th>
            <th>Year</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Awareness Corner -->
    <div class="card" id="awarenessCorner" style="background:#e8f5e9; border-left:5px solid #2e7d32; display:flex; align-items:flex-start; gap:10px;">
      <div style="font-size:2rem;">ðŸŒ±</div>
      <div>
        <h2 style="margin-top:0; color:#2e7d32;">Awareness Corner</h2>
        <p style="margin:5px 0; line-height:1.5;">
          Using digital IDs helps reduce paper waste and save energy. 
          Submit applications online, store documents digitally, and embrace eco-friendly practices 
          to contribute to a greener, more sustainable campus. Every small action counts!
        </p>
      </div>
    </div>
  </main>

  <!-- Modal -->
  <div class="modal" id="detailsModal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <div id="modalBody"></div>
    </div>
  </div>

  <script>
    const email = localStorage.getItem('ecoid_loggedIn');
    const admin = {email: "admin@example.com"};
    const tableBody = document.querySelector('#appTable tbody');
    const modal = document.getElementById('detailsModal');
    const modalBody = document.getElementById('modalBody');
    const closeBtn = document.querySelector('.close');

    if (!email) window.location.href = "login.html";

    document.getElementById('logoutBtn').onclick = () => {
      localStorage.removeItem('ecoid_loggedIn');
      window.location.href = "login.html";
    };

    let applications = JSON.parse(localStorage.getItem('ecoid_apps') || "[]");

    if (email === admin.email) {
      document.getElementById('adminDashboard').style.display = 'block';
      document.getElementById('studentFormCard').style.display = 'none';
      renderTable();
    }

    function renderTable() {
      tableBody.innerHTML = "";
      applications.forEach((app, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${app.fullName}</td>
          <td>${app.course}</td>
          <td>${app.yearLevel}</td>
          <td>${app.status || 'Processing'}</td>
          <td>
            <button class="action" onclick="viewDetails(${i})">View</button>
            <button class="delete" onclick="deleteApp(${i})">Delete</button>
          </td>`;
        tableBody.appendChild(tr);
      });
    }

    function deleteApp(i) {
      if(!confirm("Delete this application?")) return;
      applications.splice(i,1);
      localStorage.setItem('ecoid_apps', JSON.stringify(applications));
      renderTable();
    }

    function viewDetails(i) {
      const app = applications[i];
      modalBody.innerHTML = "";
      for(const key in app){
        modalBody.innerHTML += `<p><strong>${key.replace(/([A-Z])/g,' $1')}:</strong> ${app[key]}</p>`;
      }
      modal.style.display = "block";
    }

    closeBtn.onclick = () => modal.style.display = "none";
    window.onclick = (e) => { if(e.target==modal) modal.style.display="none"; }

    document.getElementById('submitApp').onclick = () => {
      const getValue = (id)=>document.getElementById(id).value.trim();
      const studentData = {
        fullName: getValue('fullName'),
        studentID: getValue('studentID'),
        dob: getValue('dob'),
        age: getValue('age'),
        gender: getValue('gender'),
        civilStatus: getValue('civilStatus'),
        nationality: getValue('nationality'),
        religion: getValue('religion'),
        bloodType: getValue('bloodType'),
        homeAddress: getValue('homeAddress'),
        mobileNumber: getValue('mobileNumber'),
        emailAddress: getValue('emailAddress'),
        emergencyPerson: getValue('emergencyPerson'),
        emergencyRelation: getValue('emergencyRelation'),
        emergencyNumber: getValue('emergencyNumber'),
        course: getValue('course'),
        yearLevel: getValue('yearLevel'),
        section: getValue('section'),
        department: getValue('department'),
        studentStatus: getValue('studentStatus'),
        fatherName: getValue('fatherName'),
        motherName: getValue('motherName'),
        guardianName: getValue('guardianName'),
        guardianContact: getValue('guardianContact'),
        guardianOccupation: getValue('guardianOccupation'),
        idType: getValue('idType'),
        assignedID: getValue('assignedID'),
        studentSignature: getValue('studentSignature'),
        registrarSignature: getValue('registrarSignature'),
        applicationDate: getValue('applicationDate'),
        photoBox: getValue('photoBox'),
        optionalBlood: getValue('optionalBlood'),
        medicalConditions: getValue('medicalConditions'),
        addressOnID: getValue('addressOnID'),
        dateOfIssuance: getValue('dateOfIssuance'),
        remarks: getValue('remarks'),
        status: 'Processing'
      };
      applications.push(studentData);
      localStorage.setItem('ecoid_apps', JSON.stringify(applications));
      alert("Application submitted successfully!");
      document.getElementById('studentFormCard').reset?.();
    };
  </script>
</body>
</html>
